<!DOCTYPE html>
<html>
<head>
    <title>Test Website Product Fetching</title>
</head>
<body>
    <h1>Testing Product Fetching from Supabase</h1>
    <div id="results"></div>

    <script type="module">
        // Test fetching products like the website would
        const SUPABASE_URL = 'https://gvcswimqaxvylgxbklbz.supabase.co';
        const ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd2Y3N3aW1xYXh2eWxneGJrbGJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM3NjA1MzAsImV4cCI6MjA2OTMzNjUzMH0.UZdiGcJXUV5VYetjWXV26inmbj2yXdiT03Z6t_5Lg24';
        
        async function testProducts() {
            const results = document.getElementById('results');
            
            // Fetch products using REST API
            const response = await fetch(`${SUPABASE_URL}/rest/v1/products?select=name,primary_image,status&status=eq.active&limit=10`, {
                headers: {
                    'apikey': ANON_KEY,
                    'Authorization': `Bearer ${ANON_KEY}`
                }
            });
            
            if (!response.ok) {
                results.innerHTML = `<p style="color: red;">Error: ${response.status} ${response.statusText}</p>`;
                return;
            }
            
            const products = await response.json();
            
            results.innerHTML = `
                <h2>Found ${products.length} products</h2>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                    ${products.map(p => `
                        <div style="border: 1px solid #ccc; padding: 10px;">
                            <h3>${p.name}</h3>
                            <img src="${p.primary_image}" 
                                 style="width: 100%; height: 200px; object-fit: cover;"
                                 onerror="this.style.background='red'; this.alt='Failed to load';"
                                 onload="this.style.border='2px solid green';">
                            <p style="font-size: 10px; word-break: break-all;">${p.primary_image}</p>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        testProducts();
    </script>
</body>
</html>